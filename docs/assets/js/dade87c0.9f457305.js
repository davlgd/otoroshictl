"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[301],{4036:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>x,frontMatter:()=>i,metadata:()=>d,toc:()=>h});var s=r(4848),o=r(8453),t=r(9229);const i={sidebar_position:1},c="Challenge proxy",d={id:"challenge/proxy",title:"Challenge proxy",description:"otoroshictl challenge proxy runs a lightweight HTTP reverse proxy that implements the Otoroshi Communication Protocol as a sidecar in front of your backend service.",source:"@site/docs/challenge/proxy.mdx",sourceDirName:"challenge",slug:"/challenge/proxy",permalink:"/otoroshictl/docs/challenge/proxy",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Challenge proxy",permalink:"/otoroshictl/docs/category/challenge-proxy"}},l={},h=[{value:"Basic usage (V2 HMAC)",id:"basic-usage-v2-hmac",level:2},{value:"V1 protocol (simple echo)",id:"v1-protocol-simple-echo",level:2},{value:"Changing the listen port and backend",id:"changing-the-listen-port-and-backend",level:2},{value:"Asymmetric algorithms (RS256, ES256, \u2026)",id:"asymmetric-algorithms-rs256-es256-",level:2},{value:"Consumer Info JWT",id:"consumer-info-jwt",level:2},{value:"Separate output header",id:"separate-output-header",level:3},{value:"Permissive mode",id:"permissive-mode",level:3},{value:"Asymmetric Consumer Info verification",id:"asymmetric-consumer-info-verification",level:3},{value:"Otoroshi header stripping",id:"otoroshi-header-stripping",level:2},{value:"Environment variables",id:"environment-variables",level:2},{value:"Command usage",id:"command-usage",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"challenge-proxy",children:"Challenge proxy"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"otoroshictl challenge proxy"})," runs a lightweight HTTP reverse proxy that implements the ",(0,s.jsx)(n.a,{href:"https://maif.github.io/otoroshi/manual/topics/otoroshi-protocol.html",children:"Otoroshi Communication Protocol"})," as a sidecar in front of your backend service."]}),"\n",(0,s.jsx)(n.p,{children:"The proxy sits between Otoroshi and your application and takes care of:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["validating the ",(0,s.jsx)(n.strong,{children:"state challenge"})," token sent by Otoroshi on every request (V1 echo or V2 JWT)"]}),"\n",(0,s.jsxs)(n.li,{children:["sending back the correct ",(0,s.jsx)(n.strong,{children:"state response"})," header so Otoroshi lets the response through"]}),"\n",(0,s.jsxs)(n.li,{children:["optionally decoding the ",(0,s.jsx)(n.strong,{children:"Consumer Info JWT"})," (",(0,s.jsx)(n.code,{children:"Otoroshi-Claims"}),") and forwarding the plain JSON payload to the backend"]}),"\n",(0,s.jsx)(n.li,{children:"stripping all Otoroshi-specific headers so they never reach your application"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Otoroshi \u2500\u2500\u25ba challenge proxy :8080 \u2500\u2500\u25ba your app :9000\n               \u2502  verify state JWT           \u2502\n               \u2502  decode consumer info       \u2502\n               \u2502  strip otoroshi headers     \u2502\n               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h2,{id:"basic-usage-v2-hmac",children:"Basic usage (V2 HMAC)"}),"\n",(0,s.jsx)(n.p,{children:"The most common setup: V2 JWT challenge with a shared HMAC secret."}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --secret my-shared-secret",result:"\nOtoroshi V2 (JWT) Challenge Proxy listening on http://0.0.0.0:8080\nForwarding requests to http://127.0.0.1:9000\n"}),"\n",(0,s.jsx)(n.h2,{id:"v1-protocol-simple-echo",children:"V1 protocol (simple echo)"}),"\n",(0,s.jsxs)(n.p,{children:["If your Otoroshi route is configured to use the V1 protocol, pass ",(0,s.jsx)(n.code,{children:"--v1"}),":"]}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --v1",result:"\nOtoroshi V1 (echo) Challenge Proxy listening on http://0.0.0.0:8080\nForwarding requests to http://127.0.0.1:9000\n"}),"\n",(0,s.jsx)(n.h2,{id:"changing-the-listen-port-and-backend",children:"Changing the listen port and backend"}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --port 8081 --backend-host 127.0.0.1 --backend-port 3000 --secret my-secret"}),"\n",(0,s.jsx)(n.h2,{id:"asymmetric-algorithms-rs256-es256-",children:"Asymmetric algorithms (RS256, ES256, \u2026)"}),"\n",(0,s.jsx)(n.p,{children:"For asymmetric algorithms you provide the private key for signing the response token. The public key used to verify the incoming challenge is extracted automatically; you can also provide it explicitly."}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --alg RS256 --secret /path/to/private.pem"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"--public-key"})," when you only have the public key (verify-only side):"]}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --alg RS256 --public-key /path/to/public.pem --response-secret /path/to/private.pem"}),"\n",(0,s.jsx)(n.p,{children:"If the signing key for the response is different from the verification key:"}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --alg RS256 --secret /path/to/in-public.pem --response-alg RS256 --response-secret /path/to/out-private.pem"}),"\n",(0,s.jsx)(n.h2,{id:"consumer-info-jwt",children:"Consumer Info JWT"}),"\n",(0,s.jsxs)(n.p,{children:["When the ",(0,s.jsx)(n.a,{href:"https://maif.github.io/otoroshi/manual/plugins/built-in-plugins.html",children:"Consumer Info"})," plugin is enabled on your Otoroshi route, it injects a signed JWT into the ",(0,s.jsx)(n.code,{children:"Otoroshi-Claims"})," header that describes the current consumer (API key, user, profile, \u2026)."]}),"\n",(0,s.jsxs)(n.p,{children:["Enable decoding with ",(0,s.jsx)(n.code,{children:"--consumer-info"})," and provide the matching secret:"]}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --secret my-secret --consumer-info --consumer-info-secret my-ci-secret"}),"\n",(0,s.jsxs)(n.p,{children:["The proxy verifies the JWT signature, decodes the payload, and ",(0,s.jsx)(n.strong,{children:"replaces the JWT with the plain JSON"})," in the same header before forwarding the request to the backend. Your backend therefore receives the consumer data as a readable JSON object rather than an opaque token."]}),"\n",(0,s.jsx)(n.h3,{id:"separate-output-header",children:"Separate output header"}),"\n",(0,s.jsxs)(n.p,{children:["To keep the original ",(0,s.jsx)(n.code,{children:"Otoroshi-Claims"})," JWT and write the decoded JSON into a different header:"]}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --secret my-secret --consumer-info --consumer-info-secret my-ci-secret --consumer-info-out-header X-Consumer-Info"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Situation"}),(0,s.jsxs)(n.th,{children:[(0,s.jsx)(n.code,{children:"Otoroshi-Claims"})," towards backend"]}),(0,s.jsxs)(n.th,{children:[(0,s.jsx)(n.code,{children:"X-Consumer-Info"})," towards backend"]})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Token valid"}),(0,s.jsx)(n.td,{children:"original JWT (kept)"}),(0,s.jsx)(n.td,{children:"decoded JSON"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Token absent / invalid (strict)"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{children:"401 returned"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Token absent / invalid (permissive)"}),(0,s.jsx)(n.td,{children:"original value (kept)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.em,{children:"(not added)"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"permissive-mode",children:"Permissive mode"}),"\n",(0,s.jsxs)(n.p,{children:["By default the proxy returns a ",(0,s.jsx)(n.code,{children:"401"})," when the Consumer Info header is absent or the token is invalid. Pass ",(0,s.jsx)(n.code,{children:"--consumer-info-permissive"})," to let the request through anyway:"]}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --secret my-secret --consumer-info --consumer-info-secret my-ci-secret --consumer-info-permissive"}),"\n",(0,s.jsx)(n.h3,{id:"asymmetric-consumer-info-verification",children:"Asymmetric Consumer Info verification"}),"\n",(0,s.jsx)(n.p,{children:"For routes where Otoroshi signs the Consumer Info JWT with an RSA or EC key:"}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --secret my-secret --consumer-info --consumer-info-alg RS256 --consumer-info-secret /path/to/public-or-private.pem"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"--consumer-info-secret"})," accepts a public key PEM, a private key PEM (the public key is extracted automatically), or a file path to either. Use ",(0,s.jsx)(n.code,{children:"--consumer-info-public-key"})," when you prefer to be explicit:"]}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --secret my-secret --consumer-info --consumer-info-alg RS256 --consumer-info-public-key /path/to/public.pem"}),"\n",(0,s.jsx)(n.h2,{id:"otoroshi-header-stripping",children:"Otoroshi header stripping"}),"\n",(0,s.jsxs)(n.p,{children:["By default the proxy strips all Otoroshi-specific headers (",(0,s.jsx)(n.code,{children:"Otoroshi-State"})," and the Consumer Info header) before forwarding the request so they never reach your application. To disable this and keep them:"]}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy --secret my-secret --keep-otoroshi-headers"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Header"}),(0,s.jsx)(n.th,{children:"Default (strip)"}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.code,{children:"--keep-otoroshi-headers"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Otoroshi-State"})}),(0,s.jsx)(n.td,{children:"removed"}),(0,s.jsx)(n.td,{children:"forwarded"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"Otoroshi-Claims"})," (or custom)"]}),(0,s.jsx)(n.td,{children:"removed"}),(0,s.jsx)(n.td,{children:"forwarded or replaced by JSON if consumer info enabled"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"environment-variables",children:"Environment variables"}),"\n",(0,s.jsx)(n.p,{children:"All flags can be set via environment variables, which is the recommended approach for production deployments."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Environment variable"}),(0,s.jsx)(n.th,{children:"Flag"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_FRONTEND_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--port"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"8080"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_BACKEND_HOST"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--backend-host"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"127.0.0.1"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_BACKEND_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--backend-port"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"9000"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_SECRET"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--secret"})}),(0,s.jsx)(n.td,{children:"\u2014"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_SECRET_BASE64"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--secret-base64"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_ALG"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--alg"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"HS512"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_PUBLIC_KEY"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--public-key"})}),(0,s.jsx)(n.td,{children:"\u2014"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_RESPONSE_SECRET"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--response-secret"})}),(0,s.jsx)(n.td,{children:"\u2014"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_RESPONSE_SECRET_BASE64"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--response-secret-base64"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_RESPONSE_ALG"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--response-alg"})}),(0,s.jsx)(n.td,{children:(0,s.jsxs)(n.em,{children:["(same as ",(0,s.jsx)(n.code,{children:"--alg"}),")"]})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_REQ_HEADER_NAME"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--state-header"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Otoroshi-State"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_RESP_HEADER_NAME"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--state-resp-header"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Otoroshi-State-Resp"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_TOKEN_TTL"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--token-ttl"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"30"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_TIMEOUT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--timeout"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"30"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_FORCE_V1"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--v1"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CHALLENGE_KEEP_HEADERS"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--keep-otoroshi-headers"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_ENABLED"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_HEADER"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info-header"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Otoroshi-Claims"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_OUT_HEADER"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info-out-header"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.em,{children:"(same as input header)"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_ALG"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info-alg"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"HS512"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_SECRET"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info-secret"})}),(0,s.jsx)(n.td,{children:"\u2014"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_SECRET_BASE64"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info-secret-base64"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_PUBLIC_KEY"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info-public-key"})}),(0,s.jsx)(n.td,{children:"\u2014"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OTOROSHI_CONSUMER_INFO_PERMISSIVE"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--consumer-info-permissive"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"command-usage",children:"Command usage"}),"\n",(0,s.jsx)(t.A,{command:"otoroshictl challenge proxy -h",result:"\nSecure backend access via Otoroshi Communication Protocol (V2 JWT by default)\n\nUsage: otoroshictl challenge proxy [OPTIONS]\n\nOptions:\n  -p, --port <PORT>\n          Port to listen on [env: OTOROSHI_CHALLENGE_FRONTEND_PORT=] [default: 8080]\n  -b, --backend-port <BACKEND_PORT>\n          Backend port to forward requests to [env: OTOROSHI_CHALLENGE_BACKEND_PORT=] [default: 9000]\n      --backend-host <BACKEND_HOST>\n          Backend host [env: OTOROSHI_CHALLENGE_BACKEND_HOST=] [default: 127.0.0.1]\n  -s, --secret <SECRET>\n          Otoroshi shared secret for JWT signing (required for V2) [env: OTOROSHI_CHALLENGE_SECRET=]\n      --secret-base64\n          Interpret the secret as base64-encoded [env: OTOROSHI_CHALLENGE_SECRET_BASE64=]\n      --alg <ALG>\n          Algorithm for JWT signing (HS256, HS384, HS512, RS256, RS384, RS512, ES256, ES384)\n          [env: OTOROSHI_CHALLENGE_ALG=] [default: HS512]\n      --public-key <PUBLIC_KEY>\n          Public key PEM file for asymmetric algorithms [env: OTOROSHI_CHALLENGE_PUBLIC_KEY=]\n      --response-secret <RESPONSE_SECRET>\n          Secret or private key for signing the response token [env: OTOROSHI_CHALLENGE_RESPONSE_SECRET=]\n      --response-secret-base64\n          Interpret the response secret as base64-encoded [env: OTOROSHI_CHALLENGE_RESPONSE_SECRET_BASE64=]\n      --response-alg <RESPONSE_ALG>\n          Algorithm for signing the response JWT [env: OTOROSHI_CHALLENGE_RESPONSE_ALG=]\n      --state-header <STATE_HEADER>\n          Header name for incoming challenge token from Otoroshi\n          [env: OTOROSHI_CHALLENGE_REQ_HEADER_NAME=] [default: Otoroshi-State]\n      --state-resp-header <STATE_RESP_HEADER>\n          Header name for response token sent back to Otoroshi\n          [env: OTOROSHI_CHALLENGE_RESP_HEADER_NAME=] [default: Otoroshi-State-Resp]\n      --token-ttl <TOKEN_TTL>\n          JWT token TTL in seconds [env: OTOROSHI_CHALLENGE_TOKEN_TTL=] [default: 30]\n      --timeout <TIMEOUT>\n          Request timeout in seconds [env: OTOROSHI_CHALLENGE_TIMEOUT=] [default: 30]\n      --v1\n          Use V1 protocol (simple echo) instead of V2 (JWT challenge) [env: OTOROSHI_CHALLENGE_FORCE_V1=]\n      --keep-otoroshi-headers\n          Keep Otoroshi headers in the request forwarded to the backend (stripped by default)\n          [env: OTOROSHI_CHALLENGE_KEEP_HEADERS=]\n      --consumer-info\n          Enable Consumer Info JWT processing [env: OTOROSHI_CONSUMER_INFO_ENABLED=]\n      --consumer-info-header <CONSUMER_INFO_HEADER>\n          Header name containing the Consumer Info JWT\n          [env: OTOROSHI_CONSUMER_INFO_HEADER=] [default: Otoroshi-Claims]\n      --consumer-info-out-header <CONSUMER_INFO_OUT_HEADER>\n          Header name for the decoded Consumer Info JSON output [env: OTOROSHI_CONSUMER_INFO_OUT_HEADER=]\n      --consumer-info-alg <CONSUMER_INFO_ALG>\n          Algorithm for Consumer Info JWT verification\n          [env: OTOROSHI_CONSUMER_INFO_ALG=] [default: HS512]\n      --consumer-info-secret <CONSUMER_INFO_SECRET>\n          HMAC secret, public key PEM, or private key PEM for Consumer Info JWT verification\n          [env: OTOROSHI_CONSUMER_INFO_SECRET=]\n      --consumer-info-secret-base64\n          Interpret the consumer info secret as base64-encoded [env: OTOROSHI_CONSUMER_INFO_SECRET_BASE64=]\n      --consumer-info-public-key <CONSUMER_INFO_PUBLIC_KEY>\n          Public key PEM for asymmetric Consumer Info JWT verification\n          [env: OTOROSHI_CONSUMER_INFO_PUBLIC_KEY=]\n      --consumer-info-permissive\n          Allow requests through even if the Consumer Info header is absent or invalid\n          [env: OTOROSHI_CONSUMER_INFO_PERMISSIVE=]\n  -h, --help\n          Print help\n"})]})}function x(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},9229:(e,n,r)=>{r.d(n,{A:()=>t});var s=r(6540),o=r(4848);class t extends s.Component{state={copy:!1};copy=()=>{this.setState({copy:!0},(()=>{navigator.clipboard.writeText(this.props.command),setTimeout((()=>{this.setState({copy:!1})}),1e3)}))};render(){const e=this.state.copy?"rgb(40, 167, 69)":"white";let n=(this.props.command||"").trim();return n.startsWith("\n")&&(n=n.substring(1)),n.startsWith("$ ")&&(n=n.substring(2)),(0,o.jsx)("div",{className:"terminal-component",style:{width:"100%",marginTop:20},children:(0,o.jsxs)("div",{style:{maxWidth:"100%",display:"flex",flexDirection:"column",borderRadius:5},children:[(0,o.jsxs)("div",{style:{borderTopLeftRadius:5,borderTopRightRadius:5,height:"2rem",gap:".35rem",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",background:"#3f52e3",color:"white"},children:[(0,o.jsx)("div",{style:{marginLeft:".35rem",width:10,height:10,borderRadius:"50%",backgroundColor:"#ccc"}}),(0,o.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",backgroundColor:"#ccc"}}),(0,o.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",backgroundColor:"#ccc"}}),(0,o.jsx)("span",{style:{width:"100%"}}),(0,o.jsx)("div",{style:{cursor:"pointer",width:30,height:30},onClick:this.copy,children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:e,className:"w-5 h-5",children:(0,o.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})})})]}),(0,o.jsxs)("pre",{style:{display:"block",overflowX:"auto",background:"#002451",color:"white",padding:"1rem 12px 1rem",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:5,borderBottomLeftRadius:5},children:[(0,o.jsx)("code",{className:"language-bash",style:{whiteSpace:"pre"},children:(0,o.jsxs)("span",{children:["$ ",n]})}),this.props.result&&(0,o.jsx)("code",{className:"language-bash",style:{whiteSpace:"pre"},children:(0,o.jsx)("span",{children:this.props.result})})]})]})})}}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>c});var s=r(6540);const o={},t=s.createContext(o);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);